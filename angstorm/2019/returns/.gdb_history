d 1
r 
ni
x/g
x/10g $esp
x/10g $rsp
x/g $rbp

x/20g $rsp
x/20gx $rsp
x/wx $rbp + 8
x/gx $rbp + 8
x/i 0x00007ffff7a05b97
x/10gx $rsp
x/12gx $rsp
r
ni
r
r
r
ni
x/12gx $rsp
x/48gx $rsp
clear
ps
exit
q
b main
r
ni
ni
'
ni
q
b main
r < tmp > fifo 
i
ni
x/wx $rbx
ni
ni
x/wx $rbp
x/gx $rbp
x/gx $rbp + 8
x/i 0x7ffff7a05b97
x/i 0x401330
x/gx 0x401330
x/2gx $rbp
q
b main
r
ni
'
ni
x/wx $rsi
x/g2x $rbp
x/2gx $rbp
x/gx $rsi
x/gx $rdi
quit
b main

ni
x/wx $rbp
x/2gx $rdi
x/20gx $rsi
x/20gx $rsp
q
b main
r < payload 
ni
x/i 0x401030
x/wx 0x404018
ni
r < tmp > fifo q
q
b main
r
ni
ni
x/i 0x401030
x/gx 0x404018
x/gx 0x401035
x/gx 0x401036
ni
x/gx 0x404018
ni
x/gx 0x404018
ni
q
r < payload 
q
b main
r < payload 
ni
4
no
mi
ni
x/gx 0x404018
mo
ni
x/gx 0x404018
ni
x/gx 0x404018
q
b *main + 349
r < payload 
ni
q
q
q
r < payload 
ni
quit
b main
q
b main
r < ./payload 
ni
x/wx 0x404018
ni
'
ni
ni
q
disas mian
disas main
b *main+216
r < payload 
ni
q
b *main+216
r < ./payload 
q
b main
r 
ni
q
b main
r < payload 
ni
x/gx $rsi
x/s $rsi
x/s $rdi
ni
ni
x/s $rsi
ni
x/s $rsi
ni
q
q
x/i $eip
x/i $rip
q
b main
r < payload 
ni
x/gx $rbx
x/gx $rsi
x/gx $rdi
x/gx $rdx
ni
ni
x/gx $rdi
x/s $rdi
ni
x/gx 0x404018
x/i 0x401036
ni
x/s $rsi
x/s $rdi
ni
q
disas main
b *main+ 195
r < payload 
ni
ni
1
q
b main
r < payload 
ni
x/gx 0x404048
ni
x/gx 0x404048
ni
x/gx 0x404048
x/i 0x7fff6b5b2ab0
x/i 0x7fff6b5b2ab0
x/i 0x7fff6b5b2ab0
ni
x/i 0x7fff6b5b2ab0
x/i 0x7fff6b5b2ab0
x/i 0x7fff6b5b2ab0
print system
q
b main
r
print system
print strcmp
q
b main
r
file ./returns 
b main
r
ni
print strcmp
print system
$1 - $2
print $1 - $2
print $2 - $1
r < payload 
ni
ls
ni
ls
exit
q
b main
r < payload 
ni
ni
x/gx $rsp
ls
x/gx $rsp
x/gx $rdx
x/s $rdx
ni
x/gx 0x404018
quit
b *main+195
r < payload 
x/gx 0x404048
ni
x/gx 0x404048
print strcmp
x/i 0x7ffff7a8de70
q
b main
 r < payload 
b main
d
b *main+195
r
r < payload 
ni
x/i 0x404048
x/gx 0x404048
x/i *0x404048
x/i 0x7ffff7a8de70
print system
q
